<div class="container mt-5 pt-5">


  <h2>{{ patient.name }}</h2>
  <p>
    <strong>Age:</strong> {{ patient.age }} <br>
    <strong>Condition:</strong> {{ patient.condition }} <br>
    <strong>Town:</strong> {{ patient.town }} <br>
  </p>

  <!-- APPOINTMENTS -->
  <div class="card shadow-sm mb-3">
    <div class="card-body">
      <h4>Your Appointments</h4>

      @if (patient.appointments.length === 0) {
        <p>You have no appointments recorded.</p>
      } @else {

        <ul class="list-group">
          @for (a of (showAllAppointments ? patient.appointments : patient.appointments.slice(0, 5)); track a._id) {
            <li class="list-group-item">
              <strong>Date:</strong> {{ a.date }} <br>
              <strong>Doctor:</strong> {{ a.doctor }} <br>
              <strong>Status:</strong> {{ a.status }}
            </li>
          }
        </ul>

        @if (patient.appointments.length > 5) {
          <button class="btn btn-link mt-2 p-0"
                  (click)="showAllAppointments = !showAllAppointments">
            {{ showAllAppointments ? 'Show Less' : 'Show More' }}
          </button>
        }
      }
    </div>
  </div>

  <!-- PRESCRIPTIONS -->
<div class="card shadow-sm mb-3">
  <div class="card-body">
    <h4>Your Prescriptions</h4>

    @if (prescriptions.length === 0) {
      <p>You have no prescriptions recorded.</p>
    } @else {

      <ul class="list-group">
        @for (p of (showAllPrescriptions ? prescriptions : prescriptions.slice(0, 5)); track p._id) {
          <li class="list-group-item">
            <strong>Medication:</strong> {{ p.name }} <br>
            <strong>Start:</strong> {{ p.start }} <br>
            <strong>Stop:</strong> {{ p.stop }} <br>
            <strong>Status:</strong> {{ p.status }}
          </li>
        }
      </ul>

      @if (prescriptions.length > 5) {
        <button class="btn btn-link mt-2 p-0"
                (click)="showAllPrescriptions = !showAllPrescriptions">
          {{ showAllPrescriptions ? 'Show Less' : 'Show More' }}
        </button>
      }
    }
  </div>
</div>

<!-- CARE PLANS -->
<div class="card shadow-sm mb-3">
  <div class="card-body">
    <h4>Your Care Plans</h4>

    @if (careplans.length === 0) {
      <p>You are not currently assigned any care plans.</p>
    } @else {

      <ul class="list-group">
        @for (c of (showAllCareplans ? careplans : careplans.slice(0, 5)); track c._id) {
          <li class="list-group-item">
            <strong>Description:</strong> {{ c.description }} <br>
            <strong>Start:</strong> {{ c.start }} <br>
            <strong>Stop:</strong> {{ c.stop }}
          </li>
        }
      </ul>

      @if (careplans.length > 5) {
        <button class="btn btn-link mt-2 p-0"
                (click)="showAllCareplans = !showAllCareplans">
          {{ showAllCareplans ? 'Show Less' : 'Show More' }}
        </button>
      }
    }
  </div>
</div>


  <!-- REQUEST APPOINTMENT -->
  <div class="card shadow-sm mb-3">
    <div class="card-body">
      <h4>Request an Appointment</h4>

      <div class="form-group mb-3">
        <label>Select Appointment Date</label>
        <input type="date" class="form-control" [(ngModel)]="requestDate">
      </div>

      <div class="form-group mb-3">
        <label>Describe Symptoms</label>
        <textarea class="form-control" rows="3"
                  [(ngModel)]="requestSymptoms"
                  placeholder="Briefly describe your symptoms"></textarea>
      </div>

      <button class="btn btn-primary" (click)="submitRequest()">
        Submit Request
      </button>

      <p class="text-success mt-2" *ngIf="submitted">
        Your appointment request has been submitted.
      </p>
    </div>
  </div>

</div>
